<mvc:View xmlns:core="sap.ui.core" xmlns:mvc="sap.ui.core.mvc" xmlns="sap.m" xmlns:f="sap.ui.layout.form" xmlns:l="sap.ui.layout" xmlns:tnt="sap.tnt"
	xmlns:plugins="sap.ui.table.plugins"
	xmlns:t="sap.ui.table" controllerName="halo.sap.mm.RECIPECOST.pages.controller.IngredientForm">
	<l:DynamicSideContent id="DynamicSideContent" class="sapUiSizeCompact" containerQuery="true" sideContentFallDown="BelowM"
		breakpointChanged="handleBreakpointChangeEvent" showSideContent="false">
		<Page title="{Name}"
			class="sapUiContentPadding sapUiResponsivePadding--header sapUiResponsivePadding--subHeader sapUiResponsivePadding--content sapUiResponsivePadding--footer"
			showNavButton="true" navButtonPress=".onNavBack">
			<headerContent>
				<Button text="{i18n>Save}" tooltip="{i18n>Save}" press=".onSave"/>
				<Button icon="sap-icon://action" tooltip="Share"/>
			</headerContent>
			<l:BlockLayout>
				<l:BlockLayoutRow>
					<l:BlockLayoutCell width="2" class="sapUiNoContentPadding">
						<l:VerticalLayout>
						<HBox>
							<Title text="{i18n>NameOfRecipe} : {Name}" titleStyle="H1" class="sapUiTinyMarginEnd"/>
						
							<tnt:InfoLabel text="{i18n>SubMaterial}" colorScheme="7" displayOnly= "true" visible="{IsSubMaterial}" class="sapUiTinyMarginTop"/>
						</HBox>
						<Label text="{i18n>ID} : {RecipeID}" class="sapUiSmallMarginBottom"/>
						
						<Title text="{i18n>PortionProduced} : {Qty} Unit"/>
						<Title text="{i18n>Location} : {LocationTxt}"/>
						<Title text="{i18n>CreatedBy} : {CreatedBy}"/>
						</l:VerticalLayout>
					</l:BlockLayoutCell>
					<l:BlockLayoutCell class="sapUiNoContentPadding">
						<FlexBox alignItems="Start" justifyContent="End">
							<Image
								src="{= '/sap/opu/odata/sap/zrecipecost_odata_srv/RecipePhotoSet(Werks=\'' + ${Werks} + '\',RecipeID=\'' + ${RecipeID} + '\')/$value' }"
								width="300px" height="180px" press="onSelectImage"/>
						</FlexBox>
					</l:BlockLayoutCell>
				</l:BlockLayoutRow>
			</l:BlockLayout>
			<t:Table id="ingredienttbl" rows="{Ingredients>/Items}"  visibleRowCount="15" paste="onPaste" ariaLabelledBy="title">
				
				<t:plugins>
					<plugins:MultiSelectionPlugin limit="20"
						enableNotification="true"
						showHeaderSelector="true"
						selectionMode="None"
						selectionChange=".onSelectMaterial"/>
				</t:plugins>
				
				
				<t:extension>
					<OverflowToolbar style="Clear">
						<Title text="{i18n>Ingredient}"/>
						<Button text="{i18n>NewVersion}" type="Transparent" tooltip="{i18n>CreateNewVersion}" press=".onCreateNewVersion"/>
						<ToolbarSpacer/>
					
						<Button text="{i18n>Delete}" type="Transparent" tooltip="{i18n>Delete}" press=".onDeleteMaterial" visible="{viewData>/ShowDelete}"/>
						<ToggleButton
							icon="sap-icon://activities"
							tooltip="{i18n>ToogleSelect}"
							pressed="false"
							press="onToggleSelect" visible="{viewData>/ShowMultiSelect}"/>
						<Button icon="sap-icon://add" type="Transparent" tooltip="Add Material(s)" press=".onVHMaterialRequested"/>
					</OverflowToolbar>
				</t:extension>
				
				<t:rowSettingsTemplate>
					<t:RowSettings highlight="{Ingredients>Status}"/>
				</t:rowSettingsTemplate>
			
				<t:columns>
					<t:Column width="7rem">
						<Label text="Material No."/>
						<t:template>
							<Text text="{Ingredients>Matnr}" wrapping="false"/>
						</t:template>
					</t:Column>
					<t:Column width="20rem">
						<Label text="Material."/>
						<t:template>
							<Text text="{Ingredients>Maktx}" wrapping="false"/>
						</t:template>
					</t:Column>
					<t:Column width="10rem" hAlign="End" headerSpan="4,1">
						<t:multiLabels>
							<Label text="{path: 'viewData>/Date/Curr', type: 'sap.ui.model.type.DateTime', formatOptions: { pattern: 'dd-MMM-yyyy' }  }" design="Bold" textAlign="Center" width="100%"/>
							<Label text="{i18n>QtyUsed}" design="Bold" textAlign="Center" width="100%"/>
						</t:multiLabels>
						<t:template>
							<Input textAlign="End" value="{ parts: [{path: 'Ingredients>TPeinh/Curr'}, {path: 'Ingredients>Bprme'}], type: 'sap.ui.model.type.Currency', formatOptions: {showMeasure: false,maxFractionDigits:3 } }" description="{Ingredients>Bprme}" visible="{= ${Ingredients>Netpr/Curr} !== null }" change=".onQtyChanged"/>
							
						</t:template>
					</t:Column>
					<t:Column width="10rem" hAlign="End">
						<t:multiLabels>
							<Label text=""/>
							<Label text="{i18n>QtyPurchased}" design="Bold" textAlign="Center" width="100%"/>
						</t:multiLabels>
						<t:template>
							<Text text="{Ingredients>Peinh/Curr} {Ingredients>Bprme}" wrapping="false" visible="{= ${Ingredients>Peinh/Curr} !== null}"/>
						</t:template>
					</t:Column>
					<t:Column width="10rem" hAlign="End" >
						<t:multiLabels>
							<Label text=""/>
							<Label text="{i18n>UnitCost}" design="Bold" textAlign="Center" width="100%"/>
						</t:multiLabels>
						<t:template>
							<Text text="{Ingredients>Netpr/Curr} {Ingredients>Waers}" wrapping="false" visible="{= ${Ingredients>Netpr/Curr} !== null }"/>
						</t:template>
					</t:Column>
					<t:Column width="10rem" >
						<t:multiLabels>
							<Label text=""/>
							<Label text="Total Cost" design="Bold" textAlign="Center" width="100%"/>
						</t:multiLabels>
						<t:template>
							<FlexBox alignItems="Start" justifyContent="End">
								<Text text="{ parts: [{path: 'Ingredients>TNetpr/Curr'}, {path: 'Ingredients>Waers'}], type: 'sap.ui.model.type.Currency', formatOptions: {showMeasure: true, minFractionDigits:2, maxFractionDigits:2 } }" wrapping="false" visible="{= ${Ingredients>Matnr} !== null  }"/>
								<Input textAlign="End" value="{ parts: [{path: 'Ingredients>AddMisc/Curr'}, {path: 'Ingredients>Waers'}], type: 'sap.ui.model.type.Currency', formatOptions: {showMeasure: false } }" description="{Ingredients>Waers}" visible="{= ${Ingredients>ID} === 'AddMisc' }" change="onAddMiscChanged"/>
								<Input textAlign="End" value="{ parts: [{path: 'Ingredients>SellPrice/Curr'}, {path: 'Ingredients>Waers'}], type: 'sap.ui.model.type.Currency', formatOptions: {showMeasure: false } }" description="{Ingredients>Waers}" visible="{= ${Ingredients>ID} === 'UnitSellPrice' }" change="onUnitSellPriceChanged"/>
								
							</FlexBox>
						</t:template>
					</t:Column>
					
					
					<t:Column width="10rem" hAlign="End" headerSpan="4,1">
						<t:multiLabels>
							<Label text="{path: 'viewData>/Date/Prev1', type: 'sap.ui.model.type.DateTime', formatOptions: { pattern: 'dd-MMM-yyyy' }  }" textAlign="Center" width="100%"/>
							<Label text="{i18n>QtyUsed}" textAlign="Center" width="100%"/>
						</t:multiLabels>
						<t:template>
							<Text text="{Ingredients>TPeinh/Prev1} {Ingredients>Bprme}" wrapping="false"/>
						</t:template>
					</t:Column>
					<t:Column width="10rem" hAlign="End">
						<t:multiLabels>
							<Label text=""/>
							<Label text="{i18n>QtyPurchased}" textAlign="Center" width="100%"/>
						</t:multiLabels>
						<t:template>
							<Text text="{Ingredients>Peinh/Prev1} {Ingredients>Bprme}" wrapping="false"/>
						</t:template>
					</t:Column>
					<t:Column width="10rem" hAlign="End">
						<t:multiLabels>
							<Label text=""/>
							<Label text="{i18n>UnitCost}" textAlign="Center" width="100%"/>
						</t:multiLabels>
						<t:template>
							<Text text="{Ingredients>Netpr/Prev1} {Ingredients>Waers}" wrapping="false" visible="{= ${Ingredients>Netpr/Prev1} !== null }"/>
						</t:template>
					</t:Column>
					<t:Column width="10rem" headerSpan="2,1">
						<t:multiLabels>
							<Label text="Date" textAlign="Center" width="100%"/>
							<Label text="Total Cost" textAlign="Center" width="100%"/>
						</t:multiLabels>
						<t:template>
							<FlexBox alignItems="Start" justifyContent="End">
								<Text text="{ parts: [{path: 'Ingredients>TNetpr/Prev1'}, {path: 'Ingredients>Waers'}], type: 'sap.ui.model.type.Currency', formatOptions: {showMeasure: true, minFractionDigits:2, maxFractionDigits:2 } }"  visible="{= ${Ingredients>Matnr} !== null  }"/>
								<Text text="{ parts: [{path: 'Ingredients>AddMisc/Prev1'}, {path: 'Ingredients>Waers'}], type: 'sap.ui.model.type.Currency', formatOptions: {showMeasure: true, minFractionDigits:2, maxFractionDigits:2 } }"  visible="{= ${Ingredients>ID} === 'AddMisc' }"/>
								<Text text="{ parts: [{path: 'Ingredients>SellPrice/Prev1'}, {path: 'Ingredients>Waers'}], type: 'sap.ui.model.type.Currency', formatOptions: {showMeasure: true, minFractionDigits:2, maxFractionDigits:2 } }"  visible="{= ${Ingredients>ID} === 'UnitSellPrice' }"/>								
							</FlexBox>
						</t:template>
					</t:Column>
					
					
					<t:Column width="10rem" hAlign="Center">
						<Label text="Last PO no."/>
						<t:template>
							<Text text="{Ingredients>Ebeln}" wrapping="false"/>
						</t:template>
					</t:Column>
				</t:columns>
				<!--<t:footer>-->
				<!--	<Label text="Total"/>-->
				<!--</t:footer>-->
			</t:Table>
		</Page>
	</l:DynamicSideContent>
</mvc:View>